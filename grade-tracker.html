<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Grade Tracker</title>
  <link rel="icon" type="image/png" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAACklEQVR4nGMAAQAABQABDQottAAAAABJRU5ErkJggg==" />
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/js/all.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    #grade-input-modal, #new-subject-modal, #set-goal-modal, #graph-modal {
      display: none;
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      background-color: rgba(0,0,0,0.5);
      z-index: 50;
    }
  </style>
</head>
<body class="bg-gray-50 min-h-screen flex flex-col">

  <div class="container mx-auto p-6 flex-grow">
    <h1 class="text-3xl font-extrabold text-center text-blue-600 mb-6">Your Grades</h1>
    <div id="subjects-list" class="space-y-6"></div>
  </div>

  <!-- Floating Buttons -->
  <button onclick="openSetGoalModal()" class="fixed bottom-[100px] right-6 bg-yellow-400 text-gray-900 rounded-full p-5 shadow-md z-50 hover:bg-yellow-500 flex items-center gap-2">
    <i class="fas fa-bullseye text-xl"></i><span>Set Goal</span>
  </button>
  <button onclick="openNewSubjectModal()" class="fixed bottom-10 right-6 bg-blue-600 text-white rounded-full p-5 shadow-md z-50 hover:bg-blue-700 flex items-center gap-2">
    <span class="text-2xl">+</span><span>Add Subject</span>
  </button>

  <!-- Bottom Navigation Bar -->
  <nav class="bg-white shadow-md p-4 flex justify-around items-center fixed bottom-0 w-full z-40">
    <a href="upcoming.html" class="flex flex-col items-center text-gray-700 hover:text-green-500">
      <i class="fas fa-clock text-2xl"></i><span class="text-sm">Upcoming</span>
    </a>
    <a href="index.html" class="flex flex-col items-center text-gray-700 hover:text-green-500">
      <i class="fas fa-home text-2xl"></i><span class="text-sm">Home</span>
    </a>
    <a href="grade-tracker.html" class="flex flex-col items-center text-gray-700 hover:text-green-500">
      <i class="fas fa-chart-line text-2xl"></i><span class="text-sm">Grade Tracker</span>
    </a>
   <a href="calendar.html" class="flex flex-col items-center text-sm font-medium text-slate-600 hover:text-blue-500">
      <i class="fas fa-calendar-alt text-xl mb-1"></i>
      Calendar
    </a>
  </nav>

  <!-- Modals (Grade Input, New Subject, Goal, Graph) -->
  <div id="grade-input-modal" class="flex items-center justify-center">
    <div class="bg-white p-8 rounded-xl shadow-lg w-96">
      <h2 class="text-2xl font-semibold text-center text-gray-800 mb-6">Input Grade</h2>
      <label for="grade" class="block mb-4 text-lg font-medium text-gray-600">Enter Grade (%)</label>
      <input type="number" id="grade" class="p-4 border-2 border-gray-300 rounded-lg w-full mb-4" placeholder="Enter grade" max="100" min="0" />
      <div class="flex justify-between gap-4">
        <button onclick="submitGrade()" class="bg-blue-600 text-white px-6 py-2 rounded-full w-full hover:bg-blue-700">Submit</button>
        <button onclick="closeGradeInput()" class="text-red-500 px-6 py-2 border-2 border-red-500 rounded-full w-full hover:bg-red-500 hover:text-white">Cancel</button>
      </div>
    </div>
  </div>

  <div id="new-subject-modal" class="flex items-center justify-center">
    <div class="bg-white p-8 rounded-xl shadow-lg w-96">
      <h2 class="text-2xl font-semibold text-center text-gray-800 mb-6">Add New Subject</h2>
      <input type="text" id="subject-name" class="p-4 border-2 border-gray-300 rounded-lg w-full mb-4" placeholder="Subject name" />
      <input type="number" id="subject-grade" class="p-4 border-2 border-gray-300 rounded-lg w-full mb-4" placeholder="Initial grade (%)" max="100" min="0" />
      <div class="flex justify-between gap-4">
        <button onclick="addSubject()" class="bg-blue-600 text-white px-6 py-2 rounded-full w-full hover:bg-blue-700">Add</button>
        <button onclick="closeNewSubjectModal()" class="text-red-500 px-6 py-2 border-2 border-red-500 rounded-full w-full hover:bg-red-500 hover:text-white">Cancel</button>
      </div>
    </div>
  </div>

  <div id="set-goal-modal" class="flex items-center justify-center">
    <div class="bg-white p-8 rounded-xl shadow-lg w-96">
      <h2 class="text-2xl font-semibold text-center text-gray-800 mb-6">Set Grade Goal</h2>
      <input type="number" id="goal-grade" class="p-4 border-2 border-gray-300 rounded-lg w-full mb-4" placeholder="Goal (%)" max="100" min="0" />
      <div class="flex justify-between gap-4">
        <button onclick="submitGoal()" class="bg-yellow-400 text-gray-900 px-6 py-2 rounded-full w-full hover:bg-yellow-500">Set Goal</button>
        <button onclick="closeSetGoalModal()" class="text-red-500 px-6 py-2 border-2 border-red-500 rounded-full w-full hover:bg-red-500 hover:text-white">Cancel</button>
      </div>
    </div>
  </div>

  <!-- Graph Modal -->
  <div id="graph-modal" class="flex items-center justify-center">
    <div class="bg-white p-6 rounded-xl shadow-lg w-[90%] max-w-2xl">
      <canvas id="gradeChart"></canvas>
      <button onclick="closeGraphModal()" class="mt-6 w-full bg-red-500 text-white py-2 rounded-full hover:bg-red-600">Close</button>
    </div>
  </div>

  <!-- Scripts -->
  <script>
    let selectedSubject = '';
    let chart = null;

    function loadSubjects() {
      const subjects = JSON.parse(localStorage.getItem('subjects')) || [];
      const gradeGoal = parseFloat(localStorage.getItem('gradeGoal')) || null;
      const list = document.getElementById('subjects-list');
      list.innerHTML = '';

      subjects.forEach((subject, index) => {
        let bg = 'bg-white';
        if (gradeGoal) {
          const diff = gradeGoal - subject.grade;
          if (diff > 15) bg = 'bg-red-100';
          else if (diff > 5) bg = 'bg-yellow-100';
        }

        const div = document.createElement('div');
        div.className = `${bg} p-6 rounded-xl shadow flex justify-between items-center`;

        div.innerHTML = `
          <div>
            <h2 class="text-xl font-semibold text-gray-800">${index + 1}. ${subject.name}</h2>
            <p class="text-sm text-gray-600">Grade: ${subject.grade}%</p>
          </div>
          <div class="flex gap-2">
            <button onclick="openGradeInput('${subject.name}')" class="text-blue-600 border-2 border-blue-600 px-4 py-1 rounded-full hover:bg-blue-600 hover:text-white">Add Grade</button>
            <button onclick="viewGraph('${subject.name}')" class="text-green-600 border-2 border-green-600 px-4 py-1 rounded-full hover:bg-green-600 hover:text-white">View Graph</button>
            <button onclick="deleteSubject('${subject.name}')" class="text-red-600 border-2 border-red-600 px-4 py-1 rounded-full hover:bg-red-600 hover:text-white">Delete</button>
          </div>
        `;
        list.appendChild(div);
      });
    }

    function openGradeInput(name) {
      selectedSubject = name;
      document.getElementById('grade').value = '';
      document.getElementById('grade-input-modal').style.display = 'flex';
    }

    function closeGradeInput() {
      document.getElementById('grade-input-modal').style.display = 'none';
    }

    function submitGrade() {
      const val = parseFloat(document.getElementById('grade').value);
      if (isNaN(val) || val < 0 || val > 100) return alert("Enter a valid grade.");

      let subjects = JSON.parse(localStorage.getItem('subjects')) || [];
      const sub = subjects.find(s => s.name === selectedSubject);
      if (sub) {
        if (!sub.grades) sub.grades = [];
        sub.grades.push(val);
        sub.grade = val;
        localStorage.setItem('subjects', JSON.stringify(subjects));
        loadSubjects();
        closeGradeInput();
      }
    }

    function openNewSubjectModal() {
      document.getElementById('subject-name').value = '';
      document.getElementById('subject-grade').value = '';
      document.getElementById('new-subject-modal').style.display = 'flex';
    }

    function closeNewSubjectModal() {
      document.getElementById('new-subject-modal').style.display = 'none';
    }

    function addSubject() {
      const name = document.getElementById('subject-name').value.trim();
      const grade = parseFloat(document.getElementById('subject-grade').value);
      if (!name || isNaN(grade) || grade < 0 || grade > 100) return alert("Enter valid name and grade.");

      let subjects = JSON.parse(localStorage.getItem('subjects')) || [];
      if (subjects.some(s => s.name.toLowerCase() === name.toLowerCase())) return alert("Subject exists.");

      subjects.push({ name, grade, grades: [grade] });
      localStorage.setItem('subjects', JSON.stringify(subjects));
      loadSubjects();
      closeNewSubjectModal();
    }

    function deleteSubject(name) {
      if (!confirm(`Delete "${name}"?`)) return;
      let subjects = JSON.parse(localStorage.getItem('subjects')) || [];
      subjects = subjects.filter(s => s.name !== name);
      localStorage.setItem('subjects', JSON.stringify(subjects));
      loadSubjects();
    }

    function openSetGoalModal() {
      document.getElementById('goal-grade').value = localStorage.getItem('gradeGoal') || '';
      document.getElementById('set-goal-modal').style.display = 'flex';
    }

    function closeSetGoalModal() {
      document.getElementById('set-goal-modal').style.display = 'none';
    }

    function submitGoal() {
      const val = parseFloat(document.getElementById('goal-grade').value);
      if (isNaN(val) || val < 0 || val > 100) return alert("Enter valid goal.");
      localStorage.setItem('gradeGoal', val);
      loadSubjects();
      closeSetGoalModal();
    }

    function viewGraph(subjectName) {
      const subjects = JSON.parse(localStorage.getItem('subjects')) || [];
      const subject = subjects.find(s => s.name === subjectName);
      if (!subject) return;

      const ctx = document.getElementById('gradeChart').getContext('2d');
      if (chart) chart.destroy();

      chart = new Chart(ctx, {
        type: 'line',
        data: {
          labels: subject.grades.map((_, i) => `Log ${i + 1}`),
          datasets: [{
            label: `${subjectName} Grade History`,
            data: subject.grades,
            borderColor: '#3b82f6',
            backgroundColor: 'rgba(59, 130, 246, 0.2)',
            fill: true,
            tension: 0.15
          }]
        },
        options: {
          scales: {
            y: {
              min: 0,
              max: 100,
              ticks: { stepSize: 10 }
            }
          }
        }
      });

      document.getElementById('graph-modal').style.display = 'flex';
    }

    function closeGraphModal() {
      document.getElementById('graph-modal').style.display = 'none';
    }

    window.onload = () => {
      if (!localStorage.getItem('subjects')) {
        localStorage.setItem('subjects', JSON.stringify([]));
      }
      loadSubjects();
    };
  </script>
</body>
</html>



